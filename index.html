<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Setlist Streamer</title>

  <!-- PWA + Icons -->
  <link rel="manifest" href="manifest.json?v=3">
  <meta name="theme-color" content="#0f0f10">
  <link rel="icon" href="icons/logo-32.png?v=3" sizes="32x32" type="image/png">
  <link rel="icon" href="icons/logo-192.png?v=3" sizes="192x192" type="image/png">
  <link rel="apple-touch-icon" href="icons/logo-180.png?v=3" sizes="180x180">
  <link rel="shortcut icon" href="icons/logo-32.png?v=3" type="image/png">

  <link rel="preconnect" href="https://archive.org">
  <link rel="stylesheet" href="styles.css?v=1">
</head>
<body>
  <!-- Status banner -->
  <div id="statusBanner" hidden data-kind="warn" class="statusBanner">
    <span id="statusMsg"></span>
    <button id="statusRetryBtn" class="statusRetryBtn">Try again</button>
  </div>

  <div class="wrap">
    <!-- Header -->
    <header>
      <div class="headLeft">
        <button id="hamburger" class="hamburger" title="Menu" aria-label="Open menu"><span></span></button>
      </div>
      <div class="headCenter">
        <div id="pageTitle">Setlist Streamer <span class="crumb">— Bands</span></div>
      </div>
      <div class="headRight">
        <div id="headerActions" class="headerActions"></div>
      </div>
    </header>

    <!-- Centered band name row (only on concerts route) -->
    <div id="subHeader" class="subHeader">
      <span id="bandName"></span>
      <button id="favBandBtn" class="pillBtn" title="Favorite band">☆</button>
    </div>

    <!-- Drawer -->
    <div id="drawerBack" class="drawerBack"></div>
    <aside id="drawer" class="drawer" aria-label="Main menu">
      <div class="drawerHeader">
        <strong>Menu</strong>
        <button id="drawerClose" class="drawerClose" title="Close">✕</button>
      </div>
      <div class="drawerBody">
        <div class="menuGroup">
          <div class="menuItem" data-nav="#/bands"><span class="icon">🏠</span> <span>Home</span></div>
          <div class="menuItem" data-nav="#/favorites"><span class="icon">⭐</span> <span>Favorites</span></div>
          <div class="menuItem sub" data-nav="#/favorites/bands"><span class="icon">🎤</span> <span>Bands</span></div>
          <div class="menuItem sub" data-nav="#/favorites/concerts"><span class="icon">🎫</span> <span>Concerts</span></div>
          <div class="menuItem sub" data-nav="#/favorites/songs"><span class="icon">🎵</span> <span>Songs</span></div>
          <div class="menuItem" data-nav="#/recent"><span class="icon">🕒</span> <span>Recently Played</span></div>
          <div class="menuItem" data-nav="#/onthisday"><span class="icon">📅</span> <span>This Day in History</span></div>
        </div>
        <div class="menuGroup">
          <div class="menuTitle">Other</div>
          <div class="menuItem"><span class="icon">🔧</span> <span>Settings (placeholder)</span></div>
          <div class="menuItem"><span class="icon">❓</span> <span>Help (placeholder)</span></div>
        </div>
      </div>
    </aside>

    <!-- Bands toolbar -->
    <div class="toolbar" id="toolbar-bands">
      <div class="pill">
        <select id="sortSel" aria-label="Sort">
          <option value="downloads desc" selected>Views ↓</option>
          <option value="downloads asc">Views ↑</option>
          <option value="title asc">Title A→Z</option>
          <option value="title desc">Title Z→A</option>
        </select>
      </div>
      <div class="pill" style="flex:1 1 160px;">
        <input id="searchBox" type="search" placeholder="e.g., Grateful Dead, bluegrass" style="width:100%">
      </div>
      <button id="favToggle" class="btn">☆ Favorites</button>
      <button id="resetBtn" class="btn ghost muted">Reset</button>
    </div>

    <!-- Concerts toolbar -->
    <div class="toolbar" id="toolbar-band" style="display:none;">
      <div class="pill dropdown" id="sortDrop" aria-label="Sort">
        <button class="dropBtn" id="sortBtn">Sort</button>
        <div class="menu" id="sortMenu" role="listbox" aria-label="Sort options"></div>
      </div>
      <div class="pill dropdown" id="yearDrop" aria-label="Year">
        <button class="dropBtn" id="yearBtn">All years</button>
        <div class="menu" id="yearMenu" role="listbox" aria-label="Year options"></div>
      </div>
      <div class="pill" style="flex:1 1 160px;">
        <input id="concertSearch" type="search" placeholder="Filter (venue/city/title)" style="width:100%">
      </div>
      <button id="favConcertsToggle" class="btn" title="Show only favorites">☆ Favorites</button>
      <button id="resetConcerts" class="btn ghost muted">Reset</button>
    </div>

    <!-- Show header metadata -->
    <div id="showMeta" class="showMeta" style="display:none;">
      <div class="showHeadRow">
        <span class="showTitle" id="showTitle"></span>
        <div class="end">
          <button class="pillBtn" id="favShowBtn" title="Favorite">☆ Favorite</button>
        </div>
      </div>
      <div class="metaRow">
        <div class="metaLeft">
          <span class="chip" id="showLoc" style="display:none;"></span>
          <span class="chip" id="showDate" style="display:none;"></span>
        </div>
      </div>
    </div>

    <!-- Dynamic content -->
    <div id="content" class="grid" aria-live="polite"></div>
  </div>

  <!-- Fixed Player -->
  <div class="player" id="player">
    <div class="controls">
      <button id="P_now" class="eqBtn" title="Go to currently playing">
        <span class="eqBars" aria-hidden="true"><span style="height:60%"></span><span style="height:30%"></span><span style="height:45%"></span></span>
      </button>
      <button id="P_prev" class="btn" title="Previous">⏮</button>
      <button id="P_play" class="btn" title="Play/Pause">▶️</button>
      <button id="P_next" class="btn" title="Next">⏭</button>
      <div class="seekWrap">
        <div id="P_times"><span class="cur">0:00</span><span class="dur"> / 0:00</span></div>
        <input id="P_seek" type="range" min="0" max="1000" value="0" step="1" aria-label="Seek">
      </div>
      <div class="volWrap">
        <button id="P_mute" class="btn" title="Volume">🔈</button>
        <div id="volPop" class="volPop" role="dialog" aria-label="Volume">
          <div class="volRow">
            <span class="small" style="min-width:36px">Vol</span>
            <input id="P_vol" type="range" min="0" max="1" step="0.01" value="1" aria-label="Volume">
            <span id="volLabel" class="small" style="min-width:32px;text-align:right">100%</span>
          </div>
        </div>
      </div>
    </div>
    <audio id="audio" crossorigin="anonymous"></audio>
  </div>

  <script type="module" src="js/app.js?v=1"></script>
</body>
</html>
